# æ­¤æ–‡æ¡£ç”±AIç”Ÿæˆ
# ğŸ”‹ ç”µåŠ›æ§åˆ¶æ¨¡å‹ç³»ç»Ÿ (Power Control Model System) 

ä¸€ä¸ªå®Œæ•´çš„é«˜æ€§èƒ½è®¡ç®—é›†ç¾¤ç”µåŠ›éœ€æ±‚é¢„æµ‹ç³»ç»Ÿï¼Œé€šè¿‡æ·±åº¦å­¦ä¹ æŠ€æœ¯åˆ†æå†å²ä½œä¸šæ•°æ®ï¼Œå®ç°å¯¹é›†ç¾¤èŠ‚ç‚¹ä½¿ç”¨æƒ…å†µå’Œç”µåŠ›æ¶ˆè€—çš„æ™ºèƒ½é¢„æµ‹ã€‚

## ğŸ“Š é¡¹ç›®æ¦‚è¿°

æœ¬é¡¹ç›®æ˜¯ä¸€ä¸ªç«¯åˆ°ç«¯çš„HPCé›†ç¾¤èµ„æºç®¡ç†å’Œç”µåŠ›é¢„æµ‹è§£å†³æ–¹æ¡ˆï¼Œæ—¨åœ¨å¸®åŠ©æ•°æ®ä¸­å¿ƒç®¡ç†å‘˜ï¼š

- ğŸ¯ **ç²¾å‡†é¢„æµ‹**: åŸºäºå†å²æ•°æ®é¢„æµ‹æœªæ¥30åˆ†é’Ÿçš„èŠ‚ç‚¹ä½¿ç”¨æƒ…å†µ
- âš¡ **ç”µåŠ›ä¼˜åŒ–**: é€šè¿‡é¢„æµ‹ç»“æœä¼˜åŒ–é›†ç¾¤ç”µåŠ›åˆ†é…å’Œè°ƒåº¦
- ğŸ“ˆ **å®æ—¶ç›‘æ§**: æä¾›Web APIæ¥å£ï¼Œæ”¯æŒå®æ—¶é¢„æµ‹æœåŠ¡
- ğŸ§  **æ™ºèƒ½è°ƒåº¦**: è¾…åŠ©ä½œä¸šè°ƒåº¦å™¨åšå‡ºæ›´ä¼˜çš„èµ„æºåˆ†é…å†³ç­–

## ğŸ—ï¸ ç³»ç»Ÿæ¶æ„

```
power-control-model/
â”œâ”€â”€ ğŸ“„ README.md                    # é¡¹ç›®è¯´æ˜æ–‡æ¡£
â”œâ”€â”€ ğŸ”§ process_sql.py              # æ•°æ®åº“ä½œä¸šæ•°æ®æå–è„šæœ¬
â”œâ”€â”€ ğŸš« .gitignore                  # Gitå¿½ç•¥é…ç½®
â”‚
â”œâ”€â”€ ğŸ¤– trainer/                    # æ¨¡å‹è®­ç»ƒæ¨¡å—
â”‚   â”œâ”€â”€ config.py                 # è®­ç»ƒé…ç½®å‚æ•°
â”‚   â”œâ”€â”€ trainer.py                # ä¸»è®­ç»ƒå™¨ï¼ˆå«æ—©åœã€å­¦ä¹ ç‡è°ƒåº¦ï¼‰
â”‚   â”œâ”€â”€ model.py                  # ç¥ç»ç½‘ç»œæ¨¡å‹å®šä¹‰
â”‚   â”œâ”€â”€ data_loader.py            # æ•°æ®åŠ è½½å’Œæ‰¹å¤„ç†
â”‚   â”œâ”€â”€ data_processor.py         # æ•°æ®é¢„å¤„ç†å’Œç‰¹å¾å·¥ç¨‹
â”‚   â”œâ”€â”€ evaluator.py              # æ¨¡å‹æ€§èƒ½è¯„ä¼°
â”‚   â””â”€â”€ visualization_results/    # è®­ç»ƒå¯è§†åŒ–ç»“æœ
â”‚
â”œâ”€â”€ ğŸ’¾ model/                      # æ¨¡å‹å­˜å‚¨æ¨¡å—
â”‚   â”œâ”€â”€ checkpoint.pth            # è®­ç»ƒå¥½çš„æ¨¡å‹æƒé‡
â”‚   â””â”€â”€ dataset_scalers.pkl       # æ•°æ®æ ‡å‡†åŒ–å™¨
â”‚
â””â”€â”€ ğŸš€ predictor/                  # é¢„æµ‹æœåŠ¡æ¨¡å—
    â”œâ”€â”€ model.py                  # é¢„æµ‹æ¨¡å‹å®šä¹‰
    â”œâ”€â”€ predictor.py              # Flask Web APIæœåŠ¡
    â””â”€â”€ simGenTask.py             # ä½œä¸šç”Ÿæˆæ¨¡æ‹Ÿå™¨
```

## â­ æ ¸å¿ƒåŠŸèƒ½ç‰¹æ€§

### ğŸ” 1. æ•°æ®å¤„ç†å¼•æ“ (`process_sql.py`)

- **æ•°æ®æº**: ä»MySQLæ•°æ®åº“ä¸­æå–HPCä½œä¸šæ‰§è¡Œè®°å½•
- **æ™ºèƒ½è§£æ**: è‡ªåŠ¨è§£æèŠ‚ç‚¹åˆ†é…ä¿¡æ¯ã€CPUéœ€æ±‚ã€è¿è¡Œæ—¶é—´ç­‰
- **æ—¶é—´åºåˆ—ç”Ÿæˆ**: æŒ‰åˆ†é’Ÿçº§åˆ«èšåˆç”Ÿæˆå®Œæ•´çš„é›†ç¾¤ä½¿ç”¨æ—¶é—´åºåˆ—
- **ç‰¹å¾è®¡ç®—**: 
  - âœ… è¿è¡Œä½œä¸šæ•°é‡ç»Ÿè®¡
  - âœ… ç­‰å¾…é˜Ÿåˆ—é•¿åº¦åˆ†æ  
  - âœ… æ´»è·ƒèŠ‚ç‚¹æ•°é‡è¿½è¸ª
  - âœ… CPUå¹³å‡å ç”¨ç‡è®¡ç®—
  - âœ… ä½œä¸šå¹³å‡èµ„æºéœ€æ±‚åˆ†æ
  - âœ… è¿è¡Œæ—¶é—´åˆ†å¸ƒç»Ÿè®¡

### ğŸ§  2. æ·±åº¦å­¦ä¹ é¢„æµ‹æ¨¡å‹ (`trainer/model.py`)

é‡‡ç”¨ä¸šç•Œå…ˆè¿›çš„æ—¶é—´åºåˆ—é¢„æµ‹æ¶æ„ï¼š

- **ğŸ”„ åŒå‘LSTMç½‘ç»œ**: 
  - 2å±‚åŒå‘LSTMï¼Œéšè—ç»´åº¦128
  - æ•è·å†å²æ•°æ®ä¸­çš„åŒå‘æ—¶é—´ä¾èµ–å…³ç³»
  - æ”¯æŒå˜é•¿åºåˆ—è¾“å…¥
  
- **ğŸ¯ å¤šå¤´è‡ªæ³¨æ„åŠ›æœºåˆ¶**:
  - 4ä¸ªæ³¨æ„åŠ›å¤´ï¼Œå¢å¼ºé•¿æœŸä¾èµ–å»ºæ¨¡
  - è‡ªé€‚åº”æƒé‡åˆ†é…ï¼Œçªå‡ºé‡è¦æ—¶é—´ç‚¹
  
- **âš™ï¸ å¤šæ¨¡æ€ç‰¹å¾èåˆ**:
  - å†å²åºåˆ—ç‰¹å¾ (è¿‡å»4å°æ—¶æ•°æ®)
  - æ—¶é—´å‘¨æœŸç‰¹å¾ (å°æ—¶ã€æ˜ŸæœŸã€æœˆä»½)  
  - å†å²åŒæœŸç‰¹å¾ (åŒä¸€æ—¶é—´ç‚¹çš„å†å²æ¨¡å¼)
  
- **ğŸ›ï¸ å…ˆè¿›æ­£åˆ™åŒ–æŠ€æœ¯**:
  - Dropouté˜²è¿‡æ‹Ÿåˆ (20%ä¸¢å¼ƒç‡)
  - Batch NormalizationåŠ é€Ÿæ”¶æ•›
  - æ¢¯åº¦è£å‰ªé˜²æ¢¯åº¦çˆ†ç‚¸

### ğŸš‚ 3. æ™ºèƒ½è®­ç»ƒç³»ç»Ÿ (`trainer/trainer.py`)

å®Œæ•´çš„æ·±åº¦å­¦ä¹ è®­ç»ƒæµæ°´çº¿ï¼š

- **ğŸ“Š è‡ªå®šä¹‰æŸå¤±å‡½æ•°**: 
  - ç»“åˆHuber Loss (é²æ£’æ€§) + å¹³æ»‘æ­£åˆ™é¡¹
  - é€‚åº”ç”µåŠ›é¢„æµ‹åœºæ™¯çš„ç‰¹æ®Šéœ€æ±‚
  
- **ğŸ“š é«˜çº§å­¦ä¹ ç‡ç­–ç•¥**:
  - çº¿æ€§é¢„çƒ­ (å‰5è½®) + è‡ªé€‚åº”è¡°å‡
  - ReduceLROnPlateauç›‘æ§éªŒè¯æŸå¤±
  - æœ€å°å­¦ä¹ ç‡ä¿æŠ¤æœºåˆ¶
  
- **â¹ï¸ æ—©åœä¸æ£€æŸ¥ç‚¹**:
  - éªŒè¯æŸå¤±æ— æ”¹å–„æ—¶è‡ªåŠ¨åœæ­¢
  - æœ€ä½³æ¨¡å‹è‡ªåŠ¨ä¿å­˜
  - å®Œæ•´è®­ç»ƒå†å²è®°å½•

### ğŸŒ 4. ç”Ÿäº§çº§é¢„æµ‹æœåŠ¡ (`predictor/predictor.py`)

åŸºäºFlaskçš„é«˜æ€§èƒ½Web APIæœåŠ¡ï¼š

- **ğŸ“¡ å®æ—¶æ•°æ®æ¥å…¥**: 
  - InfluxDBæ—¶åºæ•°æ®åº“é›†æˆ
  - è‡ªåŠ¨æ•°æ®è´¨é‡æ£€æŸ¥å’Œæ¸…æ´—
  
- **ğŸ”® æ™ºèƒ½é¢„æµ‹å¼•æ“**:
  - åŸºäºè®­ç»ƒå¥½çš„æ¨¡å‹è¿›è¡Œå®æ—¶æ¨ç†
  - æ”¯æŒå¤šèŠ‚ç‚¹å¹¶å‘é¢„æµ‹
  - è‡ªåŠ¨å¼‚å¸¸æ£€æµ‹å’Œå®¹é”™
  
- **ğŸ–¥ï¸ RESTful APIæ¥å£**:
  ```bash
  POST /predict    # èŠ‚ç‚¹ä½¿ç”¨é‡é¢„æµ‹
  GET  /health     # æœåŠ¡å¥åº·æ£€æŸ¥
  ```

### ğŸ® 5. ä½œä¸šæ¨¡æ‹Ÿå™¨ (`predictor/simGenTask.py`)

æ™ºèƒ½çš„HPCä½œä¸šè´Ÿè½½æ¨¡æ‹Ÿå™¨ï¼š

- **â° æ—¶é—´æ„ŸçŸ¥è°ƒåº¦**: å·¥ä½œæ—¶é—´vséå·¥ä½œæ—¶é—´ä¸åŒçš„æäº¤æ¨¡å¼
- **ğŸ“Š çœŸå®è´Ÿè½½æ¨¡æ‹Ÿ**: åŸºäºæ³Šæ¾åˆ†å¸ƒçš„ä½œä¸šåˆ°è¾¾è¿‡ç¨‹
- **ğŸ’¥ çªå‘è´Ÿè½½æ”¯æŒ**: éšæœºçªå‘ä»»åŠ¡ç”Ÿæˆï¼Œæ¨¡æ‹Ÿé«˜å³°æœŸåœºæ™¯  
- **ğŸ¯ å¤šæ ·åŒ–ä½œä¸šç±»å‹**: çŸ­ä»»åŠ¡ã€å¸¸è§„ä»»åŠ¡ã€é•¿ä»»åŠ¡çš„æ··åˆç”Ÿæˆ

## ğŸ› ï¸ æŠ€æœ¯æ ˆè¯¦æƒ…

### ğŸ¤– æœºå™¨å­¦ä¹ æ¡†æ¶
- **PyTorch 1.9+**: æ·±åº¦å­¦ä¹ æ¨¡å‹æ„å»ºå’Œè®­ç»ƒ
- **NumPy**: é«˜æ€§èƒ½æ•°å€¼è®¡ç®—
- **Pandas**: æ•°æ®å¤„ç†å’Œåˆ†æ
- **Scikit-learn**: æ•°æ®é¢„å¤„ç†å’Œè¯„ä¼°æŒ‡æ ‡

### ğŸŒ WebæœåŠ¡æŠ€æœ¯  
- **Flask**: è½»é‡çº§Webæ¡†æ¶
- **Waitress**: WSGIç”Ÿäº§æœåŠ¡å™¨
- **InfluxDB**: æ—¶åºæ•°æ®å­˜å‚¨
- **PyMySQL**: MySQLæ•°æ®åº“è¿æ¥

### ğŸ“Š æ•°æ®å¯è§†åŒ–
- **Matplotlib**: è®­ç»ƒæ›²çº¿å’Œç»“æœå¯è§†åŒ–
- **Seaborn**: ç»Ÿè®¡å›¾è¡¨ç»˜åˆ¶

## ğŸš€ å¿«é€Ÿå¼€å§‹

### ğŸ“‹ ç¯å¢ƒè¦æ±‚

```bash
# Pythonç¯å¢ƒ
Python >= 3.8

# æ ¸å¿ƒä¾èµ–
torch >= 1.9.0
numpy >= 1.20.0  
pandas >= 1.3.0
scikit-learn >= 1.0.0
flask >= 2.0.0
pymysql >= 1.0.0
influxdb-client >= 1.24.0
matplotlib >= 3.4.0
```

### âš™ï¸ å®‰è£…é…ç½®

1. **å…‹éš†é¡¹ç›®**
```bash
git clone <repository-url>
cd power-control-model
```

2. **å®‰è£…ä¾èµ–**
```bash
pip install torch numpy pandas scikit-learn flask pymysql influxdb-client matplotlib pyyaml waitress joblib holidays
```

3. **é…ç½®æ•°æ®åº“** (ä¿®æ”¹ `process_sql.py`)
```python
DB_CONFIG = {
    'host': 'your-mysql-host',
    'user': 'your-username', 
    'password': 'your-password',
    'database': 'your-database',
    'charset': 'utf8mb4'
}
```

### ğŸ“Š æ•°æ®å‡†å¤‡ä¸è®­ç»ƒ

1. **æå–ä½œä¸šæ•°æ®**
```bash
python process_sql.py
# è¾“å‡º: wm2/job_timeline_YYYY.csv
```

2. **å¯åŠ¨æ¨¡å‹è®­ç»ƒ**  
```bash
cd trainer
# ä¿®æ”¹config.pyä¸­çš„æ•°æ®è·¯å¾„
python trainer.py
```

3. **æ¨¡å‹è¯„ä¼°**
```bash
python evaluator.py
```

### ğŸš€ éƒ¨ç½²é¢„æµ‹æœåŠ¡

1. **å‡†å¤‡é…ç½®æ–‡ä»¶** (`config.yaml`)
```yaml
Predictor:
  URL: "http://0.0.0.0:5000"
  CheckpointFile: "../model/checkpoint.pth"
  ScalersFile: "../model/dataset_scalers.pkl"
  ForecastMinutes: 30
  LookbackMinutes: 240

InfluxDB:
  URL: "http://localhost:8086"
  Token: "your-influxdb-token"
  Org: "your-org"
  Bucket: "your-bucket"
```

2. **å¯åŠ¨é¢„æµ‹æœåŠ¡**
```bash
cd predictor
python predictor.py -c config.yaml
```

3. **æµ‹è¯•API**
```bash
curl -X POST http://localhost:5000/predict \
  -H "Content-Type: application/json" \
  -d '{"total_nodes": 120}'
```

## ğŸ“ˆ æ€§èƒ½æŒ‡æ ‡

### ğŸ¯ æ¨¡å‹å‡†ç¡®æ€§
- **MAE** (å¹³å‡ç»å¯¹è¯¯å·®): < 2.5 èŠ‚ç‚¹
- **RMSE** (å‡æ–¹æ ¹è¯¯å·®): < 4.0 èŠ‚ç‚¹  
- **MAPE** (å¹³å‡ç»å¯¹ç™¾åˆ†æ¯”è¯¯å·®): < 15%
- **RÂ²** (å†³å®šç³»æ•°): > 0.85

### âš¡ æœåŠ¡æ€§èƒ½
- **é¢„æµ‹å»¶è¿Ÿ**: < 100ms
- **APIååé‡**: > 100 QPS  
- **æ¨¡å‹å¤§å°**: < 50MB
- **å†…å­˜å ç”¨**: < 1GB

## ğŸ“ æ ¸å¿ƒé…ç½®æ–‡ä»¶

### `trainer/config.py` - è®­ç»ƒé…ç½®
```python
MODEL_CONFIG = {
    'epochs': 100,           # æœ€å¤§è®­ç»ƒè½®æ•°
    'batch_size': 256,       # æ‰¹é‡å¤§å°
    'learning_rate': 0.001,  # åˆå§‹å­¦ä¹ ç‡  
    'lookback_minutes': 240, # å†å²çª—å£(4å°æ—¶)
    'forecast_minutes': 30,  # é¢„æµ‹çª—å£(30åˆ†é’Ÿ)
    'total_nodes': 120,      # é›†ç¾¤èŠ‚ç‚¹æ€»æ•°
}
```

### è¾“å‡ºæ–‡ä»¶è¯´æ˜

**è®­ç»ƒè¾“å‡º**:
- `model/checkpoint.pth`: æœ€ä½³æ¨¡å‹æƒé‡
- `model/dataset_scalers.pkl`: æ•°æ®æ ‡å‡†åŒ–å™¨
- `trainer/logs/`: è®­ç»ƒæ—¥å¿—å’Œå¯è§†åŒ–ç»“æœ

**æ•°æ®å¤„ç†è¾“å‡º**:
- `wm2/job_timeline_YYYY.csv`: å¹´åº¦ä½œä¸šæ—¶é—´çº¿æ•°æ®

## ğŸ¤ å‚ä¸è´¡çŒ®

æˆ‘ä»¬æ¬¢è¿ç¤¾åŒºè´¡çŒ®ï¼è¯·éµå¾ªä»¥ä¸‹æµç¨‹ï¼š

1. ğŸ´ Forkæœ¬é¡¹ç›®
2. ğŸŒŸ åˆ›å»ºåŠŸèƒ½åˆ†æ”¯ (`git checkout -b feature/amazing-feature`)  
3. âœ… æäº¤æ›´æ”¹ (`git commit -m 'Add amazing feature'`)
4. ğŸ“¤ æ¨é€åˆ†æ”¯ (`git push origin feature/amazing-feature`)
5. ğŸ”€ åˆ›å»ºPull Request

## ğŸ“œ å¼€æºåè®®

æœ¬é¡¹ç›®åŸºäº **MIT License** å¼€æºï¼Œè¯¦è§ [LICENSE](LICENSE) æ–‡ä»¶ã€‚

## ğŸ“ è”ç³»æˆ‘ä»¬

- ğŸ“§ Email: [project-email]
- ğŸ› Issues: [GitHub Issues](https://github.com/your-repo/issues)
- ğŸ“– Wiki: [é¡¹ç›®æ–‡æ¡£](https://github.com/your-repo/wiki)

---

<div align="center">

**ğŸ”‹ è®©AIä¸ºæ‚¨çš„æ•°æ®ä¸­å¿ƒèŠ‚èƒ½å‡æ’ï¼**

Made with â¤ï¸ for the HPC Community

</div>
